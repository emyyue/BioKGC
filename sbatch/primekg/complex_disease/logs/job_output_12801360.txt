Gonna sleep 1.689341667755262 seconds. Good night!!
cfg  {'output_dir': '/lustre/groups/crna01/projects/genefunction/NBFNet/experiments', 'dataset': {'class': 'biomedical', 'path': '/lustre/groups/crna01/datasets/primekg/disease_split/cardiovascular_42/', 'include_factgraph': True}, 'task': {'class': 'KnowledgeGraphCompletionBiomed', 'model': {'class': 'NBFNet', 'input_dim': 32, 'hidden_dims': [32, 32, 32, 32, 32, 32], 'message_func': 'distmult', 'aggregate_func': 'pna', 'short_cut': True, 'layer_norm': True, 'dependent': True, 'symmetric': True}, 'criterion': 'bce', 'num_negative': 64, 'strict_negative': True, 'adversarial_temperature': 0.5, 'sample_weight': False, 'heterogeneous_negative': True, 'heterogeneous_evaluation': True, 'gene_annotation_predict': False, 'conditional_probability': True, 'full_batch_eval': True}, 'optimizer': {'class': 'Adam', 'lr': 0.001}, 'engine': {'gpus': [0], 'batch_size': 8}, 'train': {'num_epoch': 10, 'batch_per_epoch': 1000}, 'metric': 'mrr'}
14:18:51   Config file: /home/icb/samuele.firmani/NBFNet/config/knowledge_graph/primekg/cardiovascular.yaml
14:18:51   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/lustre/groups/crna01/datasets/primekg/disease_split/cardiovascular_42/'},
 'engine': {'batch_size': 8, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.001},
 'output_dir': '/lustre/groups/crna01/projects/genefunction/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'gene_annotation_predict': False,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'batch_per_epoch': 1000, 'num_epoch': 10}}
14:19:00   biomedical(
  #entity: 129375
  #relation: 30
  #triplet: 5847903
)
14:19:00   #train: 32036, #valid: 4577, #test: 5770
14:19:01   Preprocess training set
14:19:27   {'batch_size': 8,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.001,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(30),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'include_factgraph': True,
                          'path': '/lustre/groups/crna01/datasets/primekg/disease_split/cardiovascular_42/',
                          'verbose': 1},
              'indices': range(5842133, 5847903)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'include_factgraph': True,
                           'path': '/lustre/groups/crna01/datasets/primekg/disease_split/cardiovascular_42/',
                           'verbose': 1},
               'indices': range(5805520, 5837556)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'include_factgraph': True,
                           'path': '/lustre/groups/crna01/datasets/primekg/disease_split/cardiovascular_42/',
                           'verbose': 1},
               'indices': range(5837556, 5842133)}}
14:19:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:19:27   Epoch 0 begin
14:19:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:19:36   binary cross entropy: 0.718437
14:28:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:28:15   binary cross entropy: 0.534606
14:36:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:36:52   binary cross entropy: 0.436169
14:45:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:45:29   binary cross entropy: 0.275769
14:54:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:54:06   binary cross entropy: 0.25045
15:02:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:02:43   binary cross entropy: 0.200851
15:11:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:11:20   binary cross entropy: 0.510907
15:19:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:19:58   binary cross entropy: 0.126146
15:28:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:28:37   binary cross entropy: 0.282839
15:37:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:37:15   binary cross entropy: 0.382279
15:45:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:45:47   Epoch 0 end
15:45:47   duration: 1.44 hours
15:45:47   speed: 0.19 batch / sec
15:45:47   ETA: 0.00 secs
15:45:47   max GPU memory: 28050.9 MiB
15:45:47   ------------------------------
15:45:47   average binary cross entropy: 0.425943
15:45:47   Save checkpoint to model_epoch_1.pth
15:45:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:45:49   Evaluate on valid
16:02:47   ------------------------------
16:02:47   ap: 0.98352
16:02:47   auroc: 0.978558
16:02:47   hits@1: 0.543369
16:02:47   hits@10: 0.795718
16:02:47   hits@100: 0.930959
16:02:47   hits@3: 0.673039
16:02:47   mr: 59.5826
16:02:47   mrr: 0.628553
16:02:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:02:47   Epoch 1 begin
16:02:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:02:52   binary cross entropy: 0.555786
16:11:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:11:29   binary cross entropy: 0.183418
16:20:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:20:06   binary cross entropy: 0.212771
16:28:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:28:44   binary cross entropy: 0.253227
16:37:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:21   binary cross entropy: 0.264142
16:45:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:58   binary cross entropy: 0.340832
16:54:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:35   binary cross entropy: 0.519872
17:03:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:12   binary cross entropy: 0.424946
17:11:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:49   binary cross entropy: 0.617674
17:20:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:26   binary cross entropy: 0.246722
17:28:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:28:58   Epoch 1 end
17:28:58   duration: 1.72 hours
17:28:58   speed: 0.16 batch / sec
17:28:58   ETA: 0.00 secs
17:28:58   max GPU memory: 28182.2 MiB
17:28:59   ------------------------------
17:28:59   average binary cross entropy: 0.356978
17:28:59   Save checkpoint to model_epoch_2.pth
17:29:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:29:00   Evaluate on valid
17:45:56   ------------------------------
17:45:56   ap: 0.986636
17:45:56   auroc: 0.982596
17:45:56   hits@1: 0.60225
17:45:56   hits@10: 0.823793
17:45:56   hits@100: 0.935001
17:45:56   hits@3: 0.714114
17:45:56   mr: 58.1388
17:45:56   mrr: 0.676196
17:45:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:56   Epoch 2 begin
17:45:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:46:01   binary cross entropy: 0.215191
17:54:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:54:38   binary cross entropy: 0.244454
18:03:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:03:15   binary cross entropy: 0.671302
18:11:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:11:52   binary cross entropy: 0.53985
18:20:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:20:30   binary cross entropy: 0.527919
18:29:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:29:07   binary cross entropy: 1.08535
18:37:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:37:44   binary cross entropy: 0.167064
18:46:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:46:21   binary cross entropy: 0.293067
18:54:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:54:58   binary cross entropy: 0.396004
19:03:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:03:35   binary cross entropy: 0.207407
19:12:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:12:07   Epoch 2 end
19:12:07   duration: 1.72 hours
19:12:07   speed: 0.16 batch / sec
19:12:07   ETA: 0.00 secs
19:12:07   max GPU memory: 28182.2 MiB
19:12:08   ------------------------------
19:12:08   average binary cross entropy: 0.334216
19:12:08   Save checkpoint to model_epoch_3.pth
19:12:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:12:09   Evaluate on valid
19:29:04   ------------------------------
19:29:04   ap: 0.990022
19:29:04   auroc: 0.986928
19:29:04   hits@1: 0.599301
19:29:04   hits@10: 0.832641
19:29:04   hits@100: 0.940354
19:29:04   hits@3: 0.719795
19:29:04   mr: 53.8784
19:29:04   mrr: 0.678055
19:29:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:29:04   Epoch 3 begin
19:29:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:29:09   binary cross entropy: 0.675656
19:37:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:37:46   binary cross entropy: 0.336914
19:46:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:46:24   binary cross entropy: 0.245758
19:54:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:55:01   binary cross entropy: 0.293792
20:03:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:03:38   binary cross entropy: 0.634543
20:12:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:12:15   binary cross entropy: 0.125138
20:20:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:20:52   binary cross entropy: 0.262905
20:29:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:29:29   binary cross entropy: 0.26226
20:38:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:38:06   binary cross entropy: 0.261402
20:46:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:44   binary cross entropy: 0.500374
20:55:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:55:15   Epoch 3 end
20:55:15   duration: 1.72 hours
20:55:15   speed: 0.16 batch / sec
20:55:15   ETA: 0.00 secs
20:55:15   max GPU memory: 28182.2 MiB
20:55:16   ------------------------------
20:55:16   average binary cross entropy: 0.327927
20:55:16   Save checkpoint to model_epoch_4.pth
20:55:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:55:17   Evaluate on valid
21:12:13   ------------------------------
21:12:13   ap: 0.991419
21:12:13   auroc: 0.988932
21:12:13   hits@1: 0.623553
21:12:13   hits@10: 0.843784
21:12:13   hits@100: 0.943085
21:12:13   hits@3: 0.746122
21:12:13   mr: 51.8645
21:12:13   mrr: 0.700941
21:12:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:12:13   Epoch 4 begin
21:12:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:12:18   binary cross entropy: 0.273347
21:20:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:20:55   binary cross entropy: 0.40851
21:29:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:29:32   binary cross entropy: 0.31714
21:38:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:38:09   binary cross entropy: 0.460219
21:46:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:46:46   binary cross entropy: 0.436674
21:55:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:55:24   binary cross entropy: 0.159915
22:03:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:04:01   binary cross entropy: 0.821908
22:12:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:12:38   binary cross entropy: 0.530334
22:21:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:21:15   binary cross entropy: 0.257249
22:29:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:29:53   binary cross entropy: 0.544905
22:38:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:38:24   Epoch 4 end
22:38:24   duration: 1.72 hours
22:38:24   speed: 0.16 batch / sec
22:38:24   ETA: 0.00 secs
22:38:24   max GPU memory: 28182.2 MiB
22:38:25   ------------------------------
22:38:25   average binary cross entropy: 0.313792
22:38:25   Save checkpoint to model_epoch_5.pth
22:38:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:38:25   Evaluate on valid
22:55:25   ------------------------------
22:55:25   ap: 0.990255
22:55:25   auroc: 0.987005
22:55:25   hits@1: 0.611427
22:55:25   hits@10: 0.842582
22:55:25   hits@100: 0.94374
22:55:25   hits@3: 0.734542
22:55:25   mr: 47.8772
22:55:25   mrr: 0.690512
22:55:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:55:25   Epoch 5 begin
22:55:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:55:30   binary cross entropy: 0.679142
23:04:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:04:07   binary cross entropy: 0.276507
23:12:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:45   binary cross entropy: 0.33921
23:21:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:21:22   binary cross entropy: 0.174427
23:29:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:29:59   binary cross entropy: 0.182541
23:38:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:38:37   binary cross entropy: 0.5454
23:47:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:47:14   binary cross entropy: 0.412691
23:55:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:55:51   binary cross entropy: 0.54253
00:04:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:04:28   binary cross entropy: 0.512516
00:13:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:13:06   binary cross entropy: 0.437032
00:21:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:38   Epoch 5 end
00:21:38   duration: 1.72 hours
00:21:38   speed: 0.16 batch / sec
00:21:38   ETA: 0.00 secs
00:21:38   max GPU memory: 28182.2 MiB
00:21:38   ------------------------------
00:21:38   average binary cross entropy: 0.302465
00:21:38   Save checkpoint to model_epoch_6.pth
00:21:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:39   Evaluate on valid
00:38:34   ------------------------------
00:38:34   ap: 0.993649
00:38:34   auroc: 0.991818
00:38:34   hits@1: 0.621805
00:38:34   hits@10: 0.849792
00:38:34   hits@100: 0.948001
00:38:34   hits@3: 0.750382
00:38:34   mr: 45.0081
00:38:34   mrr: 0.701095
00:38:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:38:34   Epoch 6 begin
00:38:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:38:40   binary cross entropy: 0.176976
00:47:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:47:17   binary cross entropy: 0.0897849
00:55:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:55:54   binary cross entropy: 0.213945
01:04:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:04:31   binary cross entropy: 0.186899
01:13:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:09   binary cross entropy: 0.293427
01:21:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:46   binary cross entropy: 0.109319
01:30:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:23   binary cross entropy: 0.253548
01:38:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:39:00   binary cross entropy: 0.167435
01:47:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:47:38   binary cross entropy: 0.178598
01:56:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:56:15   binary cross entropy: 0.399771
02:04:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:04:47   Epoch 6 end
02:04:47   duration: 1.72 hours
02:04:47   speed: 0.16 batch / sec
02:04:47   ETA: 0.00 secs
02:04:47   max GPU memory: 28182.2 MiB
02:04:47   ------------------------------
02:04:47   average binary cross entropy: 0.29901
02:04:47   Save checkpoint to model_epoch_7.pth
02:04:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:04:49   Evaluate on valid
